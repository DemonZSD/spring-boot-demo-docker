<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.weshzhu.dbtool.doc.dao.TablesDao">

    <resultMap type="org.weshzhu.dbtool.common.entity.Tables" id="TablesMap">
        <result property="tableCatalog" column="TABLE_CATALOG" jdbcType="VARCHAR"/>
        <result property="tableSchema" column="TABLE_SCHEMA" jdbcType="VARCHAR"/>
        <result property="tableName" column="TABLE_NAME" jdbcType="VARCHAR"/>
        <result property="tableType" column="TABLE_TYPE" jdbcType="VARCHAR"/>
        <result property="engine" column="ENGINE" jdbcType="VARCHAR"/>
        <result property="version" column="VERSION" jdbcType="INTEGER"/>
        <result property="rowFormat" column="ROW_FORMAT" jdbcType="VARCHAR"/>
        <result property="tableRows" column="TABLE_ROWS" jdbcType="INTEGER"/>
        <result property="avgRowLength" column="AVG_ROW_LENGTH" jdbcType="INTEGER"/>
        <result property="dataLength" column="DATA_LENGTH" jdbcType="INTEGER"/>
        <result property="maxDataLength" column="MAX_DATA_LENGTH" jdbcType="INTEGER"/>
        <result property="indexLength" column="INDEX_LENGTH" jdbcType="INTEGER"/>
        <result property="dataFree" column="DATA_FREE" jdbcType="INTEGER"/>
        <result property="autoIncrement" column="AUTO_INCREMENT" jdbcType="INTEGER"/>
        <result property="createTime" column="CREATE_TIME" jdbcType="TIMESTAMP"/>
        <result property="updateTime" column="UPDATE_TIME" jdbcType="TIMESTAMP"/>
        <result property="checkTime" column="CHECK_TIME" jdbcType="TIMESTAMP"/>
        <result property="tableCollation" column="TABLE_COLLATION" jdbcType="VARCHAR"/>
        <result property="checksum" column="CHECKSUM" jdbcType="INTEGER"/>
        <result property="createOptions" column="CREATE_OPTIONS" jdbcType="VARCHAR"/>
        <result property="tableComment" column="TABLE_COMMENT" jdbcType="VARCHAR"/>
    </resultMap>

    <!--查询单个-->
    <select id="queryByTableName" resultMap="TablesMap">
        select TABLE_CATALOG,
               TABLE_SCHEMA,
               TABLE_NAME,
               TABLE_TYPE,
               ENGINE,
               VERSION,
               ROW_FORMAT,
               TABLE_ROWS,
               AVG_ROW_LENGTH,
               DATA_LENGTH,
               MAX_DATA_LENGTH,
               INDEX_LENGTH,
               DATA_FREE,
               AUTO_INCREMENT,
               CREATE_TIME,
               UPDATE_TIME,
               CHECK_TIME,
               TABLE_COLLATION,
               CHECKSUM,
               CREATE_OPTIONS,
               TABLE_COMMENT
        from TABLES
        where TABLE_SCHEMA = #{schemaName}
        and TABLE_NAME = #{tableName}
    </select>



    <!--查询指定行数据-->
    <select id="queryAllBySchema" resultMap="TablesMap">
        select
        TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, TABLE_TYPE, ENGINE, VERSION, ROW_FORMAT, TABLE_ROWS, AVG_ROW_LENGTH,
        DATA_LENGTH, MAX_DATA_LENGTH, INDEX_LENGTH, DATA_FREE, AUTO_INCREMENT, CREATE_TIME, UPDATE_TIME, CHECK_TIME,
        TABLE_COLLATION, CHECKSUM, CREATE_OPTIONS, TABLE_COMMENT
        from TABLES
        where TABLE_SCHEMA = #{tableSchema}
    </select>

    <!--统计总行数-->
    <select id="count" resultType="java.lang.Long">
        select count(1)
        from TABLES
        <where>
            <if test="tableCatalog != null and tableCatalog != ''">
                and TABLE_CATALOG = #{tableCatalog}
            </if>
            <if test="tableSchema != null and tableSchema != ''">
                and TABLE_SCHEMA = #{tableSchema}
            </if>
            <if test="tableName != null and tableName != ''">
                and TABLE_NAME = #{tableName}
            </if>
            <if test="tableType != null and tableType != ''">
                and TABLE_TYPE = #{tableType}
            </if>
            <if test="engine != null and engine != ''">
                and ENGINE = #{engine}
            </if>
            <if test="version != null">
                and VERSION = #{version}
            </if>
            <if test="rowFormat != null and rowFormat != ''">
                and ROW_FORMAT = #{rowFormat}
            </if>
            <if test="tableRows != null">
                and TABLE_ROWS = #{tableRows}
            </if>
            <if test="avgRowLength != null">
                and AVG_ROW_LENGTH = #{avgRowLength}
            </if>
            <if test="dataLength != null">
                and DATA_LENGTH = #{dataLength}
            </if>
            <if test="maxDataLength != null">
                and MAX_DATA_LENGTH = #{maxDataLength}
            </if>
            <if test="indexLength != null">
                and INDEX_LENGTH = #{indexLength}
            </if>
            <if test="dataFree != null">
                and DATA_FREE = #{dataFree}
            </if>
            <if test="autoIncrement != null">
                and AUTO_INCREMENT = #{autoIncrement}
            </if>
            <if test="createTime != null">
                and CREATE_TIME = #{createTime}
            </if>
            <if test="updateTime != null">
                and UPDATE_TIME = #{updateTime}
            </if>
            <if test="checkTime != null">
                and CHECK_TIME = #{checkTime}
            </if>
            <if test="tableCollation != null and tableCollation != ''">
                and TABLE_COLLATION = #{tableCollation}
            </if>
            <if test="checksum != null">
                and CHECKSUM = #{checksum}
            </if>
            <if test="createOptions != null and createOptions != ''">
                and CREATE_OPTIONS = #{createOptions}
            </if>
            <if test="tableComment != null and tableComment != ''">
                and TABLE_COMMENT = #{tableComment}
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="" useGeneratedKeys="true">
        insert into TABLES(TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, TABLE_TYPE, ENGINE, VERSION, ROW_FORMAT, TABLE_ROWS,
                           AVG_ROW_LENGTH, DATA_LENGTH, MAX_DATA_LENGTH, INDEX_LENGTH, DATA_FREE, AUTO_INCREMENT,
                           CREATE_TIME, UPDATE_TIME, CHECK_TIME, TABLE_COLLATION, CHECKSUM, CREATE_OPTIONS,
                           TABLE_COMMENT)
        values (#{tableCatalog}, #{tableSchema}, #{tableName}, #{tableType}, #{engine}, #{version}, #{rowFormat},
                #{tableRows}, #{avgRowLength}, #{dataLength}, #{maxDataLength}, #{indexLength}, #{dataFree},
                #{autoIncrement}, #{createTime}, #{updateTime}, #{checkTime}, #{tableCollation}, #{checksum},
                #{createOptions}, #{tableComment})
    </insert>

    <insert id="insertBatch" keyProperty="" useGeneratedKeys="true">
        insert into TABLES(TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, TABLE_TYPE, ENGINE, VERSION, ROW_FORMAT, TABLE_ROWS,
        AVG_ROW_LENGTH, DATA_LENGTH, MAX_DATA_LENGTH, INDEX_LENGTH, DATA_FREE, AUTO_INCREMENT, CREATE_TIME, UPDATE_TIME,
        CHECK_TIME, TABLE_COLLATION, CHECKSUM, CREATE_OPTIONS, TABLE_COMMENT)
        values
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.tableCatalog}, #{entity.tableSchema}, #{entity.tableName}, #{entity.tableType}, #{entity.engine},
            #{entity.version}, #{entity.rowFormat}, #{entity.tableRows}, #{entity.avgRowLength}, #{entity.dataLength},
            #{entity.maxDataLength}, #{entity.indexLength}, #{entity.dataFree}, #{entity.autoIncrement},
            #{entity.createTime}, #{entity.updateTime}, #{entity.checkTime}, #{entity.tableCollation},
            #{entity.checksum}, #{entity.createOptions}, #{entity.tableComment})
        </foreach>
    </insert>

    <insert id="insertOrUpdateBatch" keyProperty="" useGeneratedKeys="true">
        insert into TABLES(TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, TABLE_TYPE, ENGINE, VERSION, ROW_FORMAT, TABLE_ROWS,
        AVG_ROW_LENGTH, DATA_LENGTH, MAX_DATA_LENGTH, INDEX_LENGTH, DATA_FREE, AUTO_INCREMENT, CREATE_TIME, UPDATE_TIME,
        CHECK_TIME, TABLE_COLLATION, CHECKSUM, CREATE_OPTIONS, TABLE_COMMENT)
        values
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.tableCatalog}, #{entity.tableSchema}, #{entity.tableName}, #{entity.tableType}, #{entity.engine},
            #{entity.version}, #{entity.rowFormat}, #{entity.tableRows}, #{entity.avgRowLength}, #{entity.dataLength},
            #{entity.maxDataLength}, #{entity.indexLength}, #{entity.dataFree}, #{entity.autoIncrement},
            #{entity.createTime}, #{entity.updateTime}, #{entity.checkTime}, #{entity.tableCollation},
            #{entity.checksum}, #{entity.createOptions}, #{entity.tableComment})
        </foreach>
        on duplicate key update
        TABLE_CATALOG = values(TABLE_CATALOG),
        TABLE_SCHEMA = values(TABLE_SCHEMA),
        TABLE_NAME = values(TABLE_NAME),
        TABLE_TYPE = values(TABLE_TYPE),
        ENGINE = values(ENGINE),
        VERSION = values(VERSION),
        ROW_FORMAT = values(ROW_FORMAT),
        TABLE_ROWS = values(TABLE_ROWS),
        AVG_ROW_LENGTH = values(AVG_ROW_LENGTH),
        DATA_LENGTH = values(DATA_LENGTH),
        MAX_DATA_LENGTH = values(MAX_DATA_LENGTH),
        INDEX_LENGTH = values(INDEX_LENGTH),
        DATA_FREE = values(DATA_FREE),
        AUTO_INCREMENT = values(AUTO_INCREMENT),
        CREATE_TIME = values(CREATE_TIME),
        UPDATE_TIME = values(UPDATE_TIME),
        CHECK_TIME = values(CHECK_TIME),
        TABLE_COLLATION = values(TABLE_COLLATION),
        CHECKSUM = values(CHECKSUM),
        CREATE_OPTIONS = values(CREATE_OPTIONS),
        TABLE_COMMENT = values(TABLE_COMMENT)
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update TABLES
        <set>
            <if test="tableCatalog != null and tableCatalog != ''">
                TABLE_CATALOG = #{tableCatalog},
            </if>
            <if test="tableSchema != null and tableSchema != ''">
                TABLE_SCHEMA = #{tableSchema},
            </if>
            <if test="tableName != null and tableName != ''">
                TABLE_NAME = #{tableName},
            </if>
            <if test="tableType != null and tableType != ''">
                TABLE_TYPE = #{tableType},
            </if>
            <if test="engine != null and engine != ''">
                ENGINE = #{engine},
            </if>
            <if test="version != null">
                VERSION = #{version},
            </if>
            <if test="rowFormat != null and rowFormat != ''">
                ROW_FORMAT = #{rowFormat},
            </if>
            <if test="tableRows != null">
                TABLE_ROWS = #{tableRows},
            </if>
            <if test="avgRowLength != null">
                AVG_ROW_LENGTH = #{avgRowLength},
            </if>
            <if test="dataLength != null">
                DATA_LENGTH = #{dataLength},
            </if>
            <if test="maxDataLength != null">
                MAX_DATA_LENGTH = #{maxDataLength},
            </if>
            <if test="indexLength != null">
                INDEX_LENGTH = #{indexLength},
            </if>
            <if test="dataFree != null">
                DATA_FREE = #{dataFree},
            </if>
            <if test="autoIncrement != null">
                AUTO_INCREMENT = #{autoIncrement},
            </if>
            <if test="createTime != null">
                CREATE_TIME = #{createTime},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = #{updateTime},
            </if>
            <if test="checkTime != null">
                CHECK_TIME = #{checkTime},
            </if>
            <if test="tableCollation != null and tableCollation != ''">
                TABLE_COLLATION = #{tableCollation},
            </if>
            <if test="checksum != null">
                CHECKSUM = #{checksum},
            </if>
            <if test="createOptions != null and createOptions != ''">
                CREATE_OPTIONS = #{createOptions},
            </if>
            <if test="tableComment != null and tableComment != ''">
                TABLE_COMMENT = #{tableComment},
            </if>
        </set>
        where = #{}
    </update>


</mapper>

